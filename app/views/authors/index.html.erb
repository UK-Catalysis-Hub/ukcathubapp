<div class="container">
  <ul class="nav nav-tabs" id="researchersTab" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="home-tab" data-toggle="tab" href="#browse" role="tab" aria-controls="browse" aria-selected="true">Browse</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="profile-tab" data-toggle="tab" href="#statistics" role="tab" aria-controls="statistics" aria-selected="false">Statistics</a>
    </li>
    <% if user_signed_in? %>
    <li class="nav-item">
      <a class="nav-link" id="not-verified-tab" data-toggle="tab" href="#not-verified" role="tab" aria-controls="not-verified" aria-selected="false">Not verified</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="actions-tab" data-toggle="tab" href="#actions" role="tab" aria-controls="not-verified" aria-selected="false">Actions</a>
    </li>
    <% end %>
  </ul>
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="browse" role="tabpanel" aria-labelledby="browse-tab">
      <!-- Browse tab - Default with search and filtering -->
      <div class="row">
        <div class="col-md-12">
          <!-- Top DIV: search, order, reset -->
          <p id="notice"><%= notice %></p>
            <%= form_tag nil, method: :get do %>
             <!-- Field for searching by title -->
              <%= hidden_field_tag 'search[order]', @search.order.definition.request_value if @search.order %>
              <div class="row">
                <div class="col-md-1">
                  <b> Search: </b>
                </div>
                <div class="col-md-5">
                  <% last_name_filter = @search.filter(:last_name) %>
                  <%= text_field_tag 'search[last_name]', last_name_filter.value, class: 'form-control', placeholder: last_name_filter.name %>
                </div>
                <div class="col-md-4">
                  <!-- Set sort order -->
                    <button class="btn btn-success dropdown-toggle" type="button" data-toggle="dropdown"> sort by: <%= @search.order.title if @search.order %>
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                      <% @search.orders.reject(&:active).each do |order| %>
                      <li> <%= link_to order.title, order.by.path %> </li>
                      <% end %>
                    </ul>
                </div>
                <div class="col-md-2">
                  <%= link_to 'reset', '?', class: 'btn  btn-success float-right' %>
                </div>
              </div>
            <% end %>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <!-- left DIV: facet filters -->
            <%= form_tag nil, method: :get do %>
              <!-- Field for searching by title -->
              <%= hidden_field_tag 'search[order]', @search.order.definition.request_value if @search.order %>
              <!-- Facet filter for publisher -->
                <% [:given_name].each do |filter_name| %>
                   <% filter = @search.filter(filter_name) %>
                   <div class="filter">
                     <div class="filter-title">
                       <%= filter.name %>
                       <span class="small text-muted">
                         <%= "(#{filter.facet.length})" %>
                       </span>
                     </div>
                     <div class="filter-values">
                       <ul class="selected">
                         <% filter.selected.each do |entity| %>
                           <% display = entity %>
                           <li>
                             <%= link_to display, filter.remove(entity).path %>
                           </li>
                         <% end %>
                       </ul>
                       <ul class="selectable">
                         <% filter.facet.reject(&:selected).each do |facet_value| %>
                           <% entity = facet_value.entity %>
                           <li>
                             <% display = entity %>
                             <%= link_to display, filter.add(entity).path %>
                             <span class="count">
                               <%= "(#{facet_value.count})" %>
                             </span>
                           </li>
                         <% end %>
                       </ul>
                     </div>
                   </div>
                 <% end %>
               <% end %>
        </div>
        <div class="col-md-9">
          <%= render partial: 'authors/researchers_list', locals: {authors: @authors}%>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="statistics" role="tabpanel" aria-labelledby="statistics-tab">
      Statistics tab content
    </div>
    <div class="tab-pane fade" id="not-verified" role="tabpanel" aria-labelledby="not-verified-tab">
      <div class="card">
        <div class="card-header bg-light">
          <h6 style= "margin:auto">Not verified authors</h6>
        </div>
        <div class="card-body p-0" style= "margin:auto">
          <%= render partial: 'authors/filtered_list', locals: {authors: Author.not_verified}%>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="actions" role="tabpanel" aria-labelledby="actions-tab">
      Actions
    </div>
  </div> <!-- Tabs Contents-->
</div><!-- container -->
