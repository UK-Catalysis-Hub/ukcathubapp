<!-- Shared menu -->
<nav class="navbar navbar-expand-lg navbar-light bg-light navbar-fixed-top">
  <div class = "container-fluid">
    <% if AppConfig.first %>
      <a class="navbar-brand" title=<%= get_home_section.name %> href="/">
    <% else %>
      <a class="navbar-brand" title="Publications Explorer" href="/">
    <% end %>
      <% if AppConfig.first and AppConfig.first.navbar_image.attached? %>
        <%= image_tag(rails_blob_path(AppConfig.first.navbar_image),height: '40') %>
      <% else %>
        <%= image_tag('default_logo.png',height: '40') %>
      <% end %>  
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto nav-pills">
        <% if get_article_section.visible %>
        <li class="<%= 'active' if current_page?(articles_path) %>">
          <%= link_to get_article_section.name, {:controller => '/articles', :action => 'index'},
                                                {:class => "nav-link", title: "View "+ get_article_section.name}%>
        </li>
        <% end %>
        <% if get_author_section.visible %>
        <li class="<%= 'active' if current_page?(authors_path) %>" >
          <%= link_to get_author_section.name, {:controller => '/authors', :action => 'index'},
                                               {:class => "nav-link", title: "View "+ get_author_section.name} %>
        </li>
        <% end %>
        <% if get_affiliation_section.visible %>
        <li class="<%= 'active' if current_page?(affiliations_path) %>">
           <%= link_to get_affiliation_section.name, {:controller => '/affiliations', :action => 'index'},
                                                     {:class => "nav-link ", title: "View "+ get_affiliation_section.name} %>
        </li>
        <% end %>
        <% if get_do_section.visible %>
        <li class="<%= 'active' if current_page?(datasets_path) %>">
          <%= link_to get_do_section.name, {:controller => '/datasets', :action => 'index'},
                                           {:class => "nav-link ", title: "View " + get_do_section.name} %>
        </li>
        <% end %>
        <% if get_theme_section.visible %>
        <li class="<%= 'active' if current_page?(themes_path) %>">
           <%= link_to get_theme_section.name, {:controller => '/themes', :action => 'index'},
                                               {:class => "nav-link ", title: "View " + get_theme_section.name} %>
        </li>
        <% end %>

        <% if user_signed_in? %>
        <li class="<%= 'active' if current_page?(sections_path) %>">
          <%= link_to 'Sections', {:controller => '/sections', :action => 'index'}, {:class => "nav-link ", title: "View sections"} %>
        </li>
        <li class="<%= 'active' if current_page?(organisations_path) %>">
          <%= link_to 'Organisations', {:controller => '/organisations', :action => 'index'}, {:class => "nav-link ", title: "View organisations"} %>
        </li>
        <% end %>
      </ul>
      <% if user_signed_in? %>
        <ul class="navbar-nav flex-row flex-wrap ms-md-auto">
          <li>Logged in as <strong><%= current_user.email %></strong></li>
          <li><%= link_to 'Edit profile', edit_user_registration_path, :class => "btn btn-secondary btn-sm"  %></li>
          <li><%= link_to "Logout", destroy_user_session_path, data: { "turbo-method": :delete }, :class => "btn btn-danger btn-sm"  %></li>
        </ul>
      <% end %>
    </div>
  </div>
</nav>

