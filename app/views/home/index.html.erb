<%= javascript_include_tag('dashboard.js') %>
<% @authors_list = Article.active.joins(:authors).select("authors.id, full_name, COUNT(*) AS 'article_count'").order("article_count DESC").group("authors.full_name").limit(5) %>
<div class="container">
  <main role="main">
    <div class="row my-1"><!-- Qucik info row -->
      <div class="col-sm-3 col-6">
        <div class="container"><!-- info box -->
          <div class="row bg-primary  rounded border-primary">
            <div class="col-sm-6">
        			<h1><%= Article.active.count() %></h1>
        			<p>Publications</p>
        		</div>
            <div class="col-sm-6 my-1">
        			<%= image_tag('books2.svg', height: '64', width: '64', class: "rounded float-right d-block") %>
        		</div>
            <%= link_to 'More Info', articles_path, :class => "btn btn-primary btn-sm btn-block text-dark" %>
        	</div>
        </div>
      </div>  <!-- info box -->
        <div class="col-sm-3 col-6">
          <div class="container"><!-- info box -->
            <div class="row bg-secondary  rounded border-secondary my-0">
              <div class="col-sm-6">
          			<h1><%= Author.count() %></h1>
          			<p>Authors</p>
          		</div>
              <div class="col-sm-6 my-1">
          			<%= image_tag('users.svg', height: '64', width: '64', class: "rounded float-right d-block") %>
          		</div>
              <%= link_to 'More Info', authors_path, :class => "btn btn-secondary btn-sm btn-block text-dark" %>
          	</div>
        </div> <!-- info box -->
      </div>
      <div class="col-sm-3 col-6">
        <div class="container"><!-- info box -->
          <div class="row bg-success  rounded border-success">
            <div class="col-sm-6">
        			<h1><%= Affiliation.count() %></h1>
        			<p>Institutions</p>
        		</div>
            <div class="col-sm-6 my-1">
        			<%= image_tag('institution.svg', height: '64', width: '64', class: "rounded float-right d-block") %>
        		</div>
            <%= link_to 'More Info', affiliations_path, :class => "btn btn-success btn-sm btn-block text-dark" %>
        	</div>
        </div> <!-- info box -->
      </div>
      <div class="col-sm-3 col-6">
        <div class="container"><!-- info box -->
          <div class="row bg-danger  rounded border-danger ">
            <div class="col-sm-6">
              <h1><%= Dataset.count() %></h1>
              <p>Datasets</p>
            </div>
            <div class="col-sm-6 my-1">
              <%= image_tag('database.svg', height: '64', width: '64', class: "rounded float-right d-block") %>
            </div>
            <%= link_to 'More Info', datasets_path, :class => "btn btn-danger btn-sm btn-block text-dark" %>
          </div>
        </div> <!-- info box -->
      </div>
    </div>

    <div class="row px-1 my-3">
      <div class="col-sm-6 col-lg-4">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Top publishing authors</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'authors/authors_top', locals: {authors: @authors_list }%>
          </div>
          <div class="card-footer text-muted">
            By number of papers [co-]authored
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-8">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Recent publications*</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'articles/articles_recent', locals: {articles: Article.latest.limit(5) }%>
          </div>
          <div class="card-footer text-muted">
            *According to publication date
          </div>
        </div>
      </div>
    </div>

    <div class="row px-1 my-3">
      <div class="col-sm-6 col-lg-8">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Most cited publications*</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'articles/articles_referenced', locals: {articles: Article.most_cited.limit(5) }%>
          </div>
          <div class="card-footer text-muted">
            *According to Cross Ref
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-lg-4">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Most cited authors</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'authors/authors_top', locals: {authors: @authors_list }%>
          </div>
          <div class="card-footer text-muted">
            By citations in [co-]authored publications (Cross Ref)
          </div>
        </div>
      </div>
    </div>


    <div class="row mb-3">
      <div class="col-sm-4">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Most cited authors</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'authors/authors_top', locals: {authors: @authors_list }%>
          </div>
          <div class="card-footer text-muted">
            By citations in [co-]authored publications (Cross Ref)
          </div>
        </div>
      </div><!--col-sm-4-->

  		<div class="col-6 col-sm-4 themed-grid-col">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Most cited authors</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'authors/authors_top', locals: {authors: @authors_list }%>
          </div>
          <div class="card-footer text-muted">
            By citations in [co-]authored publications (Cross Ref)
          </div>
        </div>
      </div>

  		<div class="col-6 col-sm-4 themed-grid-col">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Most cited authors</h5>
          </div>
          <div class="card-body p-0">
            <%= render partial: 'authors/authors_top', locals: {authors: @authors_list }%>
          </div>
          <div class="card-footer text-muted">
            By citations in [co-]authored publications (Cross Ref)
          </div>
        </div>
      </div>
  	</div>
  </main>
</div>
